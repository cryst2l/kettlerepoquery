select  '||' + 'FROM' from_table,tb_FROM_step_DATABASE.HOST_NAME,tb_FROM_step_DATABASE.database_name tb_FROM_step_database_name,tb_FROM_step_DATABASE.USERNAME tb_FROM_step_DATABASE_USERNAME,'.' a ,tb_FROM_step_DATABASE.PASSWORD tb_FROM_step_DATABASE_PWD ,tb_TO_step_DATABASE.PASSWORD tb_TO_step_DATABASE_PWD, tb_FROM_TABLE.VALUE_STR tb_FROM_TABLE_VALUE_STR,'-->' + 'TO' to_table ,tb_TO_step_DATABASE.USERNAME tb_TO_step_DATABASE_USERNAME,'.' a, tb_TO_TABLE.VALUE_STR tb_TO_TABLE_VALUE_STR,tb2.ENABLED,  tb_FROM_TABLE.CODE tb_FROM_TRAN_CODE,tb_TO_TABLE.CODE tb_TO_TRAN_CODE, tbjob.ID_JOB R_JOB_ID_JOB,tbjob.ID_DIRECTORY R_JOB_ID_DIRECTORY,tbjob.NAME R_JOB_NAME, tbjob.DESCRIPTION  ,tbjob.EXTENDED_DESCRIPTION,tbjob.JOB_VERSION JOB_VERSION_____________,tbjob.TABLE_NAME_LOG, case when tbjob.JOB_STATUS =2 then '产品' 
when tbjob.JOB_STATUS =1 then '草稿'  end as JOB_STATUS,tbjob.MODIFIED_DATE,tbjob.CREATED_DATE,  tb_dir.ID_DIRECTORY,tb_dir.DIRECTORY_NAME,tb_dir_path.fullpath , tb1.NAME trans_name, tb1.DESCRIPTION,tb1.EXTENDED_DESCRIPTION  from R_TRANSFORMATION tb1 left join R_TRANS_HOP tb2 on tb1.ID_TRANSFORMATION = tb2.ID_TRANSFORMATION left join R_STEP_ATTRIBUTE tb_FROM_TABLE on tb_FROM_TABLE.ID_STEP = tb2.id_step_from LEFT join R_STEP_ATTRIBUTE tb_TO_TABLE   on tb_TO_TABLE.ID_STEP = tb2.id_step_to left join dbo.R_DIRECTORY tb_dir on tb_dir.ID_DIRECTORY = tb1.ID_DIRECTORY left join dbo.R_STEP_DATABASE tb_TO_step   on tb_TO_step.ID_STEP = tb_TO_TABLE.ID_STEP left join dbo.R_STEP_DATABASE tb_FROM_step on tb_FROM_step.ID_STEP = tb_FROM_TABLE.ID_STEP left join dbo.R_DATABASE tb_FROM_step_DATABASE on tb_FROM_step.ID_DATABASE = tb_FROM_step_DATABASE.ID_DATABASE left join dbo.R_DATABASE tb_TO_step_DATABASE   on tb_TO_step.ID_DATABASE = tb_TO_step_DATABASE.ID_DATABASE left join(select t1.ID_DIRECTORY, isnull('/' + t6.DIRECTORY_NAME, '') +isnull('/' + t5.DIRECTORY_NAME, '') + isnull('/' + t4.DIRECTORY_NAME, '') + isnull('/' + t3.DIRECTORY_NAME, '') + isnull('/' + t2.DIRECTORY_NAME, '') + isnull('/' + t1.DIRECTORY_NAME, '') + '/' fullpath /*t1.*,t2.*,t3.*,t4.*,t5.*,t6.*, 1.ID_DIRECTORY,isnull(t6.DIRECTORY_NAME,''), isnull(t5.DIRECTORY_NAME,''),isnull(t4.DIRECTORY_NAME,''),isnull(t3.DIRECTORY_NAME,''), isnull(t2.DIRECTORY_NAME,''), isnull(t1.DIRECTORY_NAME,'')  */from(select* from R_DIRECTORY /*where ID_DIRECTORY_PARENT =0*/ ) t1 left join R_DIRECTORY t2 on t1.ID_DIRECTORY_PARENT = t2.ID_DIRECTORY left join R_DIRECTORY t3 on t2.ID_DIRECTORY_PARENT = t3.ID_DIRECTORY left join R_DIRECTORY t4 on t3.ID_DIRECTORY_PARENT = t4.ID_DIRECTORY left join R_DIRECTORY t5 on t4.ID_DIRECTORY_PARENT = t5.ID_DIRECTORY left join R_DIRECTORY t6 on t5.ID_DIRECTORY_PARENT = t6.ID_DIRECTORY) tb_dir_path on tb_dir_path.ID_DIRECTORY = tb_dir.ID_DIRECTORY left join[dbo].[R_JOBENTRY] tbjobe on tbjobe.NAME = tb1.NAME left join[dbo].[R_JOB] tbjob on tbjob.ID_JOB = tbjobe.ID_JOB    where tb_TO_TABLE.code = 'table' and tb_FROM_TABLE.code = 'sql'and tb2.ENABLED  in  ('Y','1')and tb_TO_TABLE.VALUE_STR like '%QYWJNSB%' and tbjob.ID_JOB is not null and tbjob.JOB_STATUS is not null order by tbjob.JOB_STATUS ,tbjob.JOB_VERSION,tb_TO_step_DATABASE.USERNAME,substring(tb_TO_TABLE.VALUE_STR, 1, 4)